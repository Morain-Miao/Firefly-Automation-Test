# 米粒之光自动化测试平台

[English](README_en.md) | 中文文档

## 1.引言

### 1.1 编写目的

#### 项目名称：米粒之光自动化测试平台（Firefly-Automation-Test【FAT】）

#### 项目成员

发起人：万能的苗

#### 项目进度

目前在写对pytest的封装，计划在4月内完成pytest和完整设计文档。

#### 设计初衷

在19年年初的时候，用python写了一个自动化测试。对selenium做了封装，提供了一个exe的UI界面。当时是通过读取配置文件，无需更改代码。后来，用在升级冒烟测试，使原本3个人3小时的工作量缩短到了1个人一台电脑几分钟。这是我第一次见识到自动化的威力。而我本人也是特别懒的那种，能自动从来不手动。也开发了很多自动化的工具，比如自动Git提交代码、jenkins编译前自动修改某些文件的变量等等。

20年底，准备打造一个无需测试懂代码，只需根据业务逻辑，在可视化拼图界面生成python自动化脚本的开源自动化测试平台。

帮助广大的开发、测试人员解放双手，拥有更多的时间去学习、娱乐是本项目开发的初衷。

### 1.2 项目背景

一年没动这个项目了，最近准备重新搞起来。因为技术日新月异，现在有了更好的技术实现。

幸亏，本项目还没进行深入开发。

最近一年一直在DevOps摸爬滚打，由于公司的项目也算个初期往中期过度的阶段。本来打算引入UI和接口自动化测试解放双手，然后被问了一个灵魂拷问，就是这个测试用例和测试脚本的维护问题。因为项目不是后期阶段，虽然脚本已经做了封装，但是用例的维护就难以为继。也趁着过年这段看了Istio架构，于是为了解决这个问题（不，是降低这个问题的成本算不上解决）决定重写米粒之光项目。

目前思路比较清晰，正在重新写完整的新的架构设计文档。

目前pytest接口自动化测试部分，已经完成了一些。

### 1.2 项目概要

本项目采取GitHub开源方式，使用Apache2.0开源协议。

GitHub地址：https://github.com/Morain-Miao/Firefly-Automation-Test

## 2.总体要求

### 2.1 总体功能设计（特性）

#### 无需人工维护的自动化接口测试

- FAT支持从生产流量复制到测试环境的回归测试自动化测试脚本自动生成，并且随着接口的变更，无需人工维护。
- 在开发/测试环境的某一时间段产生的测试流量，测试人员可以快速将他们生成自动化测试脚本，并且在准出测试中使用它们来保证系统质量。

[自动化接口测试指南]()

#### 强大的Mock能力

- mock-app支持精确响应匹配、随机生成响应数据。
- 动态添加、删除路由。
- 支持swagger批量导入，支持自定义插件定义导入逻辑。

[Mock指南]()

#### 灵活接入

- 自动化测试执行、测试报告灵活接入DevOps、测试用例管理等系统。

[接入指南]()

#### 一键部署

- 在Kubernetes环境下，通过预制脚本一键初始化FAT所需环境。

[一键部署指南]()

#### 环境隔离

- 在基础设施支持的情况下，利用FAT的Mock功能轻松实现环境隔离。

[环境隔离指南]()

#### 流量镜像

- 通过goreplay/istio可以快速复制某一个某一时间段生产环境产生的流量，并把它们复现到测试环境。

[流量镜像指南]()

### 未来功能

- 基于playwright和图像OCR的AI技术，轻松实现UI自动化测试

### 2.2 总体技术设计

#### 2.2.1 基于goreplay无侵入式设计

![](https://github.com/Morain-Miao/Firefly-Automation-Test/blob/main/img/%E6%B5%81%E9%87%8F%E5%BD%95%E5%88%B6%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95.png)

#### 2.2.2 基于Istio基础设施设计

![](https://github.com/Morain-Miao/Firefly-Automation-Test/blob/main/img/istio%E6%B5%81%E9%87%8F%E5%A4%8D%E5%88%B6%E6%96%B9%E6%A1%88.png)

### 2.3 系统功能概述

- Mock（Mock-App）
    - 主要用于实现请求第三方接口的mock功能
- 脚本生成客户端（generate script client）
    - 用于pytest自动化测试脚本生成
- 脚本执行服务端（manager）
    - 组织temporal工作流
- 脚本执行客户端（worker）
    - 执行temporal任务

### 2.4 系统功能要求

- Mock（Mock-App）
    - mock数据随机生成
    - api地址路由管理
    - http模板匹配
    - 支持自定义插件（前期支持go，未来支持python、java）
    - 批量导入（路由、模板、变量、mock数据等）
- 脚本生成客户端（generate script client）
    - 接收goreplay/istio转发的流量请求响应数据
    - 记录流量（考虑接入ES，用于复现某一时间段的流量）
    - 自动生成测试用例
    - 测试结果生成、对接其他系统
    - 支持自定义插件（支持python）
    - 批量导入（Excel、jmeter等）
- 脚本执行服务端（manager）
    - 组织temporal工作流
    - 任务调度模型
    - 脚本分发
- 脚本执行客户端（worker）
    - 执行temporal任务
    - pytest脚本的具体执行者


## 3.快速开始



























